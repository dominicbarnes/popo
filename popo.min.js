/*!
 * Popo JS - v0.8.1 - 9/3/2013
 * Copyright (c) 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
(function(n,l){var c="popo",B=n.document,g=Math,j=g.abs,v="left",x="right",y="top",t="bottom",d="center",q="function",p="documentElement",b="body",o=Object.prototype.toString;function u(C){return String.prototype.trim?C.trim():C.replace(/^\s+|\s+$/g,"")}function k(G){var E={},C=G.length,D,F;for(D=0;D<C;D++){for(F in G[D]){E[F]=G[D][F]}}return E}function i(C,D){return n.getComputedStyle?(n.getComputedStyle(C,null).getPropertyValue(D)):C.currentStyle?(C.currentStyle[D]):(null)}function s(D){var C=i(D,"position"),E=D.offsetParent;if(C==="fixed"){E=n}else{if(C==="absolute"){E=D===B[b]?B[p]:E||B;while(E!==B&&i(E,"position")==="static"){E=E===B[b]?B[p]:E.offsetParent||B}}}return E}function e(C){return C===n?(B[p].clientWidth):C===B||C===B[p]?(g.max(B[p].scrollWidth,B[b].scrollWidth)):(C.getBoundingClientRect().width||C.offsetWidth)}function r(C){return C===n?(B[p].clientHeight):C===B||C===B[p]?(g.max(B[p].scrollHeight,B[b].scrollHeight)):(C.getBoundingClientRect().height||C.offsetHeight)}function h(D,J){var G=0,C=0,H=n.pageXOffset||B[p].scrollLeft||B[b].scrollLeft||0,I=n.pageYOffset||B[p].scrollTop||B[b].scrollTop||0,F,E;if(D===n){G=H;C=I}else{if(D!==B&&D!==B[p]){F=D.getBoundingClientRect();if(F&&typeof F[v]==="number"&&typeof F[y]==="number"){G+=F[v]+H-B[p].clientLeft;C+=F[y]+I-B[p].clientTop}else{G+=D.offsetLeft||0;C+=D.offsetTop||0;E=s(D);while(E){G+=E===n?H:E.offsetLeft||0;C+=E===n?I:E.offsetTop||0;E=s(E)}}if(J){G+=D.clientLeft||0;C+=D.clientTop||0}}}return{left:G,top:C}}function z(K){var F={x:0,y:0},C=parseFloat,H=1000000,I=typeof K===q?u(K()).split(","):K.split(","),D=I.length,M,L,E,J,G;for(G=0;G<D;G++){M=u(I[G]).split(" ");L=M.length;if(L===2&&M[0].indexOf("deg")>=0){E=C(M[0]);J=C(M[1]);if(typeof E==="number"&&typeof J==="number"&&J!==0){F.x+=g.round((g.cos(E*(g.PI/180))*J)*H)/H;F.y+=g.round((g.sin(E*(g.PI/180))*J)*H)/H}}else{if(L===1||L===2){F.x+=C(M[0]);F.y+=L===1?C(M[0]):C(M[1])}}}return F}function w(D){var E=typeof D==="string"&&D.length>0?D.split(" "):"",C=E.length;if(C>0&&C<5){return{left:E[0],top:C>1?E[1]:E[0],right:C>2?E[2]:E[0],bottom:C===4?E[3]:C===1?E[0]:E[1]}}else{return null}}function a(D){var C=o.call(D)==="[object Object]"?k([n[c].defaults,D]):k([n[c].defaults]),E;for(E in C){if(typeof C[E]==="string"){C[E]=u(C[E])}}C.position=typeof C.position===q?C.position().split(" "):C.position.split(" ");C.base=typeof C.base===q?C.base():C.base;C.container=typeof C.container===q?C.container():C.container;C.offset=z(C.offset);return C}function f(G,F,E,D){var C={};C[v+v]=C[y+y]=F;C[v+d]=C[y+d]=F+(E/2);C[v+x]=C[y+t]=F+E;C[d+v]=C[d+y]=F-(D/2);C[d+d]=F+(E/2)-(D/2);C[d+x]=C[d+t]=F+E-(D/2);C[x+v]=C[t+y]=F-D;C[x+d]=C[t+d]=F-D+(E/2);C[x+x]=C[t+t]=F-D+E;return C[G]}function m(C,O,G){var K=0,L="push",D=L+"!",F=G?y:v,N=G?t:x,I=C[F],J=C[N],M=O[F],H=O[N],E=M+H;if((I==L||I==D)&&(J==L||J==D)&&(M<0||H<0)){if(M<H){K-=E<0?M+j(E/2):M}if(H<M){K+=E<0?H+j(E/2):H}M+=K;H-=K;if(I==D&&J!=D&&M<0){K-=M}if(J==D&&I!=D&&H<0){K+=H}}else{if((I==D||I==L)&&M<0){K-=M}else{if((J==D||J==L)&&H<0){K+=H}}}return K}function A(M,Q,E){var O=a(Q),R=O.onCollision,T,I=e(M),J=r(M),F=h(s(M),1),V,K,L,C=O.base,U,G,S,D=O.container,N,P,H;o.call(C)==="[object Array]"?(U=G=0,S=h(C[2]||n),S[v]+=C[0],S[y]+=C[1]):(U=e(C),G=r(C),S=h(C));L={left:f(O.position[0]+O.position[2],S[v]+O.offset.x-F[v],U,I),top:f(O.position[1]+O.position[3],S[y]+O.offset.y-F[y],G,J)};if(D){o.call(D)==="[object Array]"?(N=P=0,H=h(D[2]||n),H[v]+=D[0],H[y]+=D[1]):(N=e(D),P=r(D),H=h(D));K={left:L[v]+F[v]-H[v],right:(H[v]+N)-(L[v]+F[v]+I),top:L[y]+F[y]-H[y],bottom:(H[y]+P)-(L[y]+F[y]+J)};if(typeof R===q){V=h(M);T={target:{element:M,width:I,height:J,offset:V,position:{left:V[v]>F[v]?j(V[v]-F[v]):-j(V[v]-F[v]),top:V[y]>F[y]?j(V[y]-F[y]):-j(V[y]-F[y])}},base:{element:C,width:U,height:G,offset:S},container:{element:D,width:N,height:P,offset:H}};R(L,K,T)}else{R=w(R);if(R){L[v]+=m(R,K);L[y]+=m(R,K,1)}}}if(E){M.style[v]=L[v]+"px";M.style[y]=L[y]+"px";return n}else{return L}}n[c]={set:function(C,D){return A(C,D,1)},get:function(C,D){return A(C,D)},defaults:{base:n,position:"center center center center",offset:"0",container:null,onCollision:"push"}}})(window);