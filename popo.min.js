/*!
 * Popo JS - v0.7.7 - 11/2/2013
 *
 * Copyright (c) 2013 Niklas Rämö
 * Released under the MIT license
 */
(function(n,k){var b="popo",I=n.document,C=I.documentElement,o=I.body,g=n.Math,i=g.abs,z="left",D="right",E="top",s="bottom",c="center",p="function",w="number",x=Object.prototype.toString,u={nw:[D,s,z,E],n:[c,s,c,E],ne:[z,s,D,E],e:[z,c,D,c],se:[z,E,D,s],s:[c,E,c,s],sw:[D,E,z,s],w:[D,c,z,c],center:[c,c,c,c]};function y(J){return typeof String.prototype.trim===p?J.trim():J.replace(/^\s+|\s+$/g,"")}function j(J){var L={},K,M;for(K=0;K<J.length;K++){for(M in J[K]){L[M]=J[K][M]}}return L}function d(J){return J===n?(C.clientWidth||o.clientWidth):J===I?(g.max(C.clientWidth,C.offsetWidth,C.scrollWidth,o.scrollWidth,o.offsetWidth)):(J.getBoundingClientRect().width||J.offsetWidth)}function r(J){return J===n?(C.clientHeight||o.clientHeight):J===I?(g.max(C.clientHeight,C.offsetHeight,C.scrollHeight,o.scrollHeight,o.offsetHeight)):(J.getBoundingClientRect().height||J.offsetHeight)}function A(){return typeof n.pageXOffset===w?n.pageXOffset:C.scrollLeft||o.scrollLeft}function e(){return typeof n.pageYOffset===w?n.pageYOffset:C.scrollTop||o.scrollTop}function h(K,N){var M=0,J=0,L;if(K===n){M=A();J=e()}else{if(K!==I){L=K.getBoundingClientRect();if(typeof L!=="undefined"){M=L.left+A();J=L.top+e();if(N===true){M+=K.clientLeft;J+=K.clientTop}}}}return{left:M,top:J}}function m(J){return J.style.position?(J.style.position):J.currentStyle?(J.currentStyle.position):I.defaultView&&I.defaultView.getComputedStyle?(I.defaultView.getComputedStyle(J,null).getPropertyValue("position")):("static")}function q(J){var K;if(J===C){K=I}else{if(J===o){K=C}else{K=J.offsetParent;while(K!==C&&m(K)==="static"){K=K===o?C:K.offsetParent}}}return K}function v(N){var K=m(N),Q,M,P,L,O,J;K==="fixed"?(Q={left:0,top:0}):K==="absolute"?(Q=h(q(N),true)):K!=="relative"?(Q=h(N)):(M=N.style,P=M.left,L=M.right,O=M.top,J=M.bottom,M.left=M.right=M.top=M.bottom="auto",Q=h(N),M.left=P,M.right=L,M.top=O,M.bottom=J);return Q}function H(M,O,K){var N=M.className.split(" "),J=N.length,L;for(L=0;L<J;L++){if(N[L].substring(0,O.length)===O){N.splice(L,1)}}if(K!==""){N.push(K)}M.className=N.join(" ")}function B(L){var K=typeof L==="string"&&L.length!==0?L.split(" "):"",J=K.length;return J>0&&J<5?({left:K[0],top:J>1?K[1]:K[0],right:J>2?K[2]:K[0],bottom:J===4?K[3]:J===1?K[0]:K[1]}):(null)}function F(O){var L={x:0,y:0},N=1000000,P=O.split(","),J=P.length,S,R,K,Q,M;for(M=0;M<J;M++){S=y(P[M]).split(" ");R=S.length;if(R===2&&S[0].indexOf("deg")!==-1){K=parseFloat(S[0]);Q=parseFloat(S[1]);if(typeof K===w&&typeof Q===w&&Q!==0){L.x+=g.round((g.cos(K*(g.PI/180))*Q)*N)/N;L.y+=g.round((g.sin(K*(g.PI/180))*Q)*N)/N}}else{if(R===1||R===2){L.x+=parseFloat(S[0]);L.y+=R===1?parseFloat(S[0]):parseFloat(S[1])}}}return L}function a(K){var J=x.call(K)==="[object Object]"?j([n[b].defaults,K]):j([n[b].defaults]),L;for(L in J){if(typeof J[L]==="string"){J[L]=y(J[L])}}if(J.setClass){J.cls=b+"-"+J.position.replace(/\s+/g,"-")}J.position=J.position.split(" ");J.position=J.position.length===1?u[J.position[0]].slice(0):J.position;J.offset=F(J.offset);if(J.container!==null&&typeof J.onCollision!==p){J.onCollision=B(J.onCollision)}return J}function f(N,M,L,K){var J={};J[z+z]=J[E+E]=M;J[z+c]=J[E+c]=M+(L/2);J[z+D]=J[E+s]=M+L;J[c+z]=J[c+E]=M-(K/2);J[c+c]=M+(L/2)-(K/2);J[c+D]=J[c+s]=M+L-(K/2);J[D+z]=J[s+E]=M-K;J[D+c]=J[s+c]=M-K+(L/2);J[D+D]=J[s+s]=M-K+L;return J[N]}function t(L,J,N,K,P,O,M){return{left:N.left+K.left-M.left,right:(M.left+P)-(N.left+K.left+L),top:N.top+K.top-M.top,bottom:(M.top+O)-(N.top+K.top+J)}}function l(V,R,N,M,W,X,P,Q,J){var U="push",T="push!",L=[[z,D],[E,s]],S,K,O;for(O=0;O<2;O++){S=L[O][0];K=L[O][1];if((J[S]===U||J[S]===T)&&(J[K]===U||J[K]===T)&&(Q[S]<0||Q[K]<0)){if(Q[S]>Q[K]){if(i(Q[K])<=i(Q[S])){N[S]-=i(Q[K])}else{N[S]-=((i(Q[S])+i(Q[K]))/2)}}else{if(Q[S]<Q[K]){if(i(Q[S])<=i(Q[K])){N[S]+=i(Q[S])}else{N[S]+=((i(Q[S])+i(Q[K]))/2)}}}Q=t(V,R,N,M,W,X,P);if(J[S]===T&&Q[S]<0){N[S]+=i(Q[S])}else{if(J[K]===T&&Q[K]<0){N[S]-=i(Q[K])}}}else{if((J[S]===T||J[S]===U)&&Q[S]<0){N[S]+=i(Q[S])}else{if((J[K]===T||J[K]===U)&&Q[K]<0){N[S]-=i(Q[K])}}}}}function G(L,R,W){var U=a(W),aa=x.call(U.base)==="[object Array]",O=d(R),P=r(R),T=v(R),Q,J=U.base,Z,M,Y,K,S,V,N,X;aa?(Z=M=0,Y=h(J[2]||n),Y.left+=J[0],Y.top+=J[1]):(Z=d(J),M=r(J),Y=h(J));if(U.setClass&&(" "+R.className+" ").indexOf(" "+U.cls+" ")===-1){H(R,b,U.cls)}Q={left:f(U.position[0]+U.position[2],Y.left+U.offset.x-T.left,Z,O),top:f(U.position[1]+U.position[3],Y.top+U.offset.y-T.top,M,P)};if(U.container!==null){K=U.container;S=d(K);V=r(K);N=h(K);X=t(O,P,Q,T,S,V,N);if(typeof U.onCollision===p){U.onCollision(Q,R,J,K)}else{if(U.onCollision!==null){l(O,P,Q,T,S,V,N,X,U.onCollision)}}}if(L==="set"){R.style.left=Q.left+"px";R.style.top=Q.top+"px"}else{return Q}}n[b]={set:function(J,K){G("set",J,K);return this},get:function(J,K){return G("get",J,K)},defaults:{position:c,offset:"0",base:n,setClass:false,container:null,onCollision:"push"}}})(window);