/*!
 * Popo JS - v0.8.0 - 5/3/2013
 *
 * Copyright (c) 2013 Niklas Rämö
 * Released under the MIT license
 */
(function(n,k){var a="popo",D=n.document,y=D.documentElement,p=D.body,e=Math,h=e.abs,m=parseFloat,v="left",z="right",A="top",t="bottom",b="center",q="function",o=Object.prototype.toString;function u(E){return typeof String.prototype.trim===q?E.trim():E.replace(/^\s+|\s+$/g,"")}function j(F){var H={},E=F.length,G,I;for(G=0;G<E;G++){for(I in F[G]){H[I]=F[G][I]}}return H}function g(E,F){return n.getComputedStyle?(n.getComputedStyle(E,null).getPropertyValue(F)):E.currentStyle?(E.currentStyle[F]):(null)}function c(E){return E===n?(y.clientWidth):E===D||E===y?(y.scrollWidth):(E.getBoundingClientRect().width||E.offsetWidth)}function s(E){return E===n?(y.clientHeight):E===D||E===y?(y.scrollHeight):(E.getBoundingClientRect().height||E.offsetHeight)}function f(F,K){var H=0,E=0,I=n.pageXOffset||y.scrollLeft||p.scrollLeft,J=n.pageYOffset||y.scrollTop||p.scrollTop,G;if(F===n){H=I;E=J}else{if(F!==D&&F!==y){G=F.getBoundingClientRect()||0;H+=G[v]+I-y.clientLeft;E+=G[A]+J-y.clientTop;if(K){H+=F.clientLeft;E+=F.clientTop}}}return{left:H,top:E}}function r(F){var E=g(F,"position"),G;if(E==="fixed"){G=n}else{if(E==="absolute"){G=F===p?y:F.offsetParent||D;while(G!==D&&g(G,"position")==="static"){G=G===p?y:G.offsetParent||D}}else{G=F}}return G}function B(L){var G={x:0,y:0},I=1000000,J=typeof L===q?u(L()).split(","):L.split(","),E=J.length,N,M,F,K,H;for(H=0;H<E;H++){N=u(J[H]).split(" ");M=N.length;if(M===2&&N[0].indexOf("deg")>=0){F=m(N[0]);K=m(N[1]);if(typeof F==="number"&&typeof K==="number"&&K!==0){G.x+=e.round((e.cos(F*(e.PI/180))*K)*I)/I;G.y+=e.round((e.sin(F*(e.PI/180))*K)*I)/I}}else{if(M===1||M===2){G.x+=m(N[0]);G.y+=M===1?m(N[0]):m(N[1])}}}return G}function x(G){var F=typeof G==="string"&&G.length>0?G.split(" "):"",E=F.length;if(E>0&&E<5){return{left:F[0],top:E>1?F[1]:F[0],right:E>2?F[2]:F[0],bottom:E===4?F[3]:E===1?F[0]:F[1]}}else{return null}}function w(F){var E=o.call(F)==="[object Object]"?j([n[a].defaults,F]):j([n[a].defaults]),G;for(G in E){if(typeof E[G]==="string"){E[G]=u(E[G])}}E.position=typeof E.position===q?E.position().split(" "):E.position.split(" ");E.base=typeof E.base===q?E.base():E.base;E.container=typeof E.container===q?E.container():E.container;E.offset=B(E.offset);return E}function d(I,H,G,F){var E={};E[v+v]=E[A+A]=H;E[v+b]=E[A+b]=H+(G/2);E[v+z]=E[A+t]=H+G;E[b+v]=E[b+A]=H-(F/2);E[b+b]=H+(G/2)-(F/2);E[b+z]=E[b+t]=H+G-(F/2);E[z+v]=E[t+A]=H-F;E[z+b]=E[t+b]=H-F+(G/2);E[z+z]=E[t+t]=H-F+G;return E[I]}function i(F,E,H,K,J,I,G){return{left:H[v]+K[v]-G[v],right:(G[v]+J)-(H[v]+K[v]+F),top:H[A]+K[A]-G[A],bottom:(G[A]+I)-(H[A]+K[A]+E)}}function l(P,L,I,E,Q,S,K,R,F){var O="push",N="push!",H=[[v,z],[A,t]],M,G,J;for(J=0;J<2;J++){M=H[J][0];G=H[J][1];if((F[M]===O||F[M]===N)&&(F[G]===O||F[G]===N)&&(R[M]<0||R[G]<0)){if(R[M]>R[G]){if(h(R[G])<=h(R[M])){I[M]-=h(R[G])}else{I[M]-=((h(R[M])+h(R[G]))/2)}}else{if(R[M]<R[G]){if(h(R[M])<=h(R[G])){I[M]+=h(R[M])}else{I[M]+=((h(R[M])+h(R[G]))/2)}}}R=i(P,L,I,E,Q,S,K);if(F[M]===N&&R[M]<0){I[M]+=h(R[M])}else{if(F[G]===N&&R[G]<0){I[M]-=h(R[G])}}}else{if((F[M]===N||F[M]===O)&&R[M]<0){I[M]+=h(R[M])}else{if((F[G]===N||F[G]===O)&&R[G]<0){I[M]-=h(R[G])}}}}}function C(G,N,S){var P=w(S),T=P.onCollision,M,R,K=c(N),L=s(N),H=f(r(N),true),W,E=P.base,V,I,U,F=P.container,O,Q,J;o.call(E)==="[object Array]"?(V=I=0,U=f(E[2]||n),U[v]+=E[0],U[A]+=E[1]):(V=c(E),I=s(E),U=f(E));M={left:d(P.position[0]+P.position[2],U[v]+P.offset.x-H[v],V,K),top:d(P.position[1]+P.position[3],U[A]+P.offset.y-H[A],I,L)};if(F){o.call(F)==="[object Array]"?(O=Q=0,J=f(F[2]||n),J[v]+=F[0],J[A]+=F[1]):(O=c(F),Q=s(F),J=f(F));R=i(K,L,M,H,O,Q,J);if(typeof T===q){W=f(N);T(M,R,{target:{element:N,width:K,height:L,offset:W,position:{left:W[v]>H[v]?h(W[v]-H[v]):-h(W[v]-H[v]),top:W[A]>H[A]?h(W[A]-H[A]):-h(W[A]-H[A])}},base:{element:E,width:V,height:I,offset:U},container:{element:F,width:O,height:Q,offset:J}})}else{T=x(T);if(T){l(K,L,M,H,O,Q,J,R,T)}}}if(G==="set"){N.style[v]=M[v]+"px";N.style[A]=M[A]+"px"}else{return M}}n[a]={set:function(E,F){C("set",E,F);return this},get:function(E,F){return C("get",E,F)},defaults:{base:n,position:"center center center center",offset:"0",container:null,onCollision:"push"}}})(window);