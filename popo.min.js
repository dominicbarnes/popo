/*! popo.js - v0.9.1 - 21/5/2013
 * https://github.com/niklasramo/popo
 * Copyright (c) 2012, 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license */
(function(h,e){var b="popo",g=h.parseFloat,c=h.Math,o=c.abs,d,w,u,m;function j(y,x){y=({}).toString.call(y).split(" ")[1].replace("]","").toLowerCase();return x?y===x:y}function f(x){return j(x,"string")?(x.trim?x.trim():x.replace(/^\s+|\s+$/g,"")):x}function q(B){var z={},x=B.length,y,A;for(y=0;y<x;y++){for(A in B[y]){if(B[y].hasOwnProperty(A)){z[A]=B[y][A]}}}return z}function v(x){return x.self===d.self}function n(x,y){return d.getComputedStyle?(d.getComputedStyle(x,null).getPropertyValue(y)):x.currentStyle?(x.currentStyle[y]):(null)}function i(x){var y=x.offsetParent,z="style" in x&&n(x,"position");if(z==="fixed"){y=d}else{if(z==="absolute"){y=x===m?u:y||w;while("style" in y&&n(y,"position")==="static"){y=y===m?u:y.offsetParent||w}}}return y}function k(x,y){return v(x)?(u.clientWidth):x===w||x===u?(c.max(u.scrollWidth,m.scrollWidth)):(y=x.getBoundingClientRect&&x.getBoundingClientRect(),y&&"width" in y?y.width:x.offsetWidth)}function a(x,y){return v(x)?(u.clientHeight):x===w||x===u?(c.max(u.scrollHeight,m.scrollHeight)):(y=x.getBoundingClientRect&&x.getBoundingClientRect(),y&&"height" in y?y.height:x.offsetHeight)}function r(y,E){var A=0,x=0,B=d.pageXOffset||u.scrollLeft||m.scrollLeft||0,D=d.pageYOffset||u.scrollTop||m.scrollTop||0,z=y,C;if(v(y)){A=B;x=D}else{if(y!==w&&y!==u){C=y.getBoundingClientRect&&y.getBoundingClientRect();if(C&&"left" in C&&"top" in C){A+=C.left+B-(u.clientLeft||0);x+=C.top+D-(u.clientTop||0)}else{while(z){A+=v(z)?B:z.offsetLeft||0;x+=v(z)?D:z.offsetTop||0;z=i(z)}}if(E){A+=y.clientLeft||0;x+=y.clientTop||0}}}return{left:A,top:x}}function l(B,A){var y=h[b].defaults,D,z,C,x;A=q(j(A,"object")?[y,A]:[y]);for(D in A){A[D]=f(j(A[D],"function")&&D!=="onCollision"?A[D](B):A[D]);if(D==="position"){A[D]=A[D].split(" ")}if(D==="offset"){z=j(A[D],"string")?A[D].split(" "):[];A.offsetX=g(z[0])||0;A.offsetY=z.length>1?g(z[1])||0:A.offsetX}if(D==="onCollision"){z=j(A[D],"function")?A[D]:null;if(j(A[D],"string")&&A[D].length>0){C=A[D].split(" ");x=C.length;if(x>0&&x<5){z={left:C[0],top:x>1?C[1]:C[0],right:x>2?C[2]:C[0],bottom:x>3?C[3]:x<2?C[0]:C[1]}}}A[D]=z}}return A}function p(B,A,z,y){var x={};x.leftleft=x.toptop=A;x.leftcenter=x.topcenter=A+(z/2);x.leftright=x.topbottom=A+z;x.centerleft=x.centertop=A-(y/2);x.centercenter=A+(z/2)-(y/2);x.centerright=x.centerbottom=A+z-(y/2);x.rightleft=x.bottomtop=A-y;x.rightcenter=x.bottomcenter=A-y+(z/2);x.rightright=x.bottombottom=A-y+z;return x[B]}function s(z,J,D){var H=0,I="push",G=I+"!",y=D?"top":"left",x=D?"bottom":"right",E=z[y],C=z[x],A=J[y],F=J[x],B=A+F;if((E===I||E===G)&&(C===I||C===G)&&(A<0||F<0)){if(A<F){H-=B<0?A+o(B/2):A}if(F<A){H+=B<0?F+o(B/2):F}A+=H;F-=H;if(E===G&&C!=G&&A<0){H-=A}if(C===G&&E!=G&&F<0){H+=F}}else{if((E===G||E===I)&&A<0){H-=A}else{if((C===G||C===I)&&F<0){H+=F}}}return H}function t(z,A,C){w=z.ownerDocument;d=w.defaultView||w.parentWindow;u=w.documentElement;m=w.body;C=l(z,j(A,"string")?C:A);var M=C.onCollision,F=k(z),G=a(z),B=r(i(z),1),x=C.base,O,D,N,y=C.container,K,L,E,P,J,H,I;j(x,"array")?(O=D=0,N=r(x[2]||d),N.left+=x[0],N.top+=x[1]):(O=k(x),D=a(x),N=r(x));I={left:p(C.position[0]+C.position[2],N.left+C.offsetX-B.left,O,F),top:p(C.position[1]+C.position[3],N.top+C.offsetY-B.top,D,G)};if(y){j(y,"array")?(K=L=0,E=r(y[2]||d),E.left+=y[0],E.top+=y[1]):(K=k(y),L=a(y),E=r(y));H={left:I.left+B.left-E.left,right:(E.left+K)-(I.left+B.left+F),top:I.top+B.top-E.top,bottom:(E.top+L)-(I.top+B.top+G)};if(j(M,"function")){P=r(z);J={left:P.left>B.left?o(P.left-B.left):-o(P.left-B.left),top:P.top>B.top?o(P.top-B.top):-o(P.top-B.top)};M(I,H,{target:{element:z,width:F,height:G,offset:P,position:J},base:{element:x,width:O,height:D,offset:N},container:{element:y,width:K,height:L,offset:E}})}else{if(M){I.left+=s(M,H);I.top+=s(M,H,1)}}}if(A==="get"){return I}else{z.style.left=I.left+"px";z.style.top=I.top+"px";return z}}h[b]=t;h[b].defaults={base:function(y,x){x=y.ownerDocument;return x.defaultView||x.parentWindow},position:"center center center center",offset:"0",container:null,onCollision:"none"}})(window);