/*!
 * Popo JS - v0.8.0 - 7/3/2013
 * Copyright (c) 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
(function(o,l){var b="popo",D=o.document,y=D.documentElement,q=D.body,f=Math,i=f.abs,n=parseFloat,w="left",z="right",A="top",u="bottom",c="center",r="function",p=Object.prototype.toString;function v(E){return String.prototype.trim?E.trim():E.replace(/^\s+|\s+$/g,"")}function k(I){var G={},E=I.length,F,H;for(F=0;F<E;F++){for(H in I[F]){G[H]=I[F][H]}}return G}function h(E,F){return o.getComputedStyle?(o.getComputedStyle(E,null).getPropertyValue(F)):E.currentStyle?(E.currentStyle[F]):(null)}function t(F){var E=h(F,"position"),G=F.offsetParent;if(E==="fixed"){G=o}else{if(E==="absolute"){G=F===q?y:G||D;while(G!==D&&h(G,"position")==="static"){G=G===q?y:G.offsetParent||D}}}return G}function d(E){return E===o?(y.clientWidth):E===D||E===y?(f.max(y.scrollWidth,q.scrollWidth)):(E.getBoundingClientRect().width||E.offsetWidth)}function s(E){return E===o?(y.clientHeight):E===D||E===y?(f.max(y.scrollHeight,q.scrollHeight)):(E.getBoundingClientRect().height||E.offsetHeight)}function g(F,L){var I=0,E=0,J=o.pageXOffset||y.scrollLeft||q.scrollLeft,K=o.pageYOffset||y.scrollTop||q.scrollTop,H,G;if(F===o){I=J;E=K}else{if(F!==D&&F!==y){H=F.getBoundingClientRect();if(H&&typeof H[w]==="number"&&typeof H[A]==="number"){I+=H[w]+J-y.clientLeft;E+=H[A]+K-y.clientTop}else{I+=F.offsetLeft||0;E+=F.offsetTop||0;G=t(F);while(G){I+=G===o?J:G.offsetLeft||0;E+=G===o?K:G.offsetTop||0;G=t(G)}}if(L){I+=F.clientLeft;E+=F.clientTop}}}return{left:I,top:E}}function B(L){var G={x:0,y:0},I=1000000,J=typeof L===r?v(L()).split(","):L.split(","),E=J.length,N,M,F,K,H;for(H=0;H<E;H++){N=v(J[H]).split(" ");M=N.length;if(M===2&&N[0].indexOf("deg")>=0){F=n(N[0]);K=n(N[1]);if(typeof F==="number"&&typeof K==="number"&&K!==0){G.x+=f.round((f.cos(F*(f.PI/180))*K)*I)/I;G.y+=f.round((f.sin(F*(f.PI/180))*K)*I)/I}}else{if(M===1||M===2){G.x+=n(N[0]);G.y+=M===1?n(N[0]):n(N[1])}}}return G}function x(F){var G=typeof F==="string"&&F.length>0?F.split(" "):"",E=G.length;if(E>0&&E<5){return{left:G[0],top:E>1?G[1]:G[0],right:E>2?G[2]:G[0],bottom:E===4?G[3]:E===1?G[0]:G[1]}}else{return null}}function a(F){var E=p.call(F)==="[object Object]"?k([o[b].defaults,F]):k([o[b].defaults]),G;for(G in E){if(typeof E[G]==="string"){E[G]=v(E[G])}}E.position=typeof E.position===r?E.position().split(" "):E.position.split(" ");E.base=typeof E.base===r?E.base():E.base;E.container=typeof E.container===r?E.container():E.container;E.offset=B(E.offset);return E}function e(I,H,G,F){var E={};E[w+w]=E[A+A]=H;E[w+c]=E[A+c]=H+(G/2);E[w+z]=E[A+u]=H+G;E[c+w]=E[c+A]=H-(F/2);E[c+c]=H+(G/2)-(F/2);E[c+z]=E[c+u]=H+G-(F/2);E[z+w]=E[u+A]=H-F;E[z+c]=E[u+c]=H-F+(G/2);E[z+z]=E[u+u]=H-F+G;return E[I]}function j(F,E,H,K,J,I,G){return{left:H[w]+K[w]-G[w],right:(G[w]+J)-(H[w]+K[w]+F),top:H[A]+K[A]-G[A],bottom:(G[A]+I)-(H[A]+K[A]+E)}}function m(P,L,I,E,Q,S,K,R,F){var O="push",N="push!",H=[[w,z],[A,u]],M,G,J;for(J=0;J<2;J++){M=H[J][0];G=H[J][1];if((F[M]===O||F[M]===N)&&(F[G]===O||F[G]===N)&&(R[M]<0||R[G]<0)){if(R[M]>R[G]){if(i(R[G])<=i(R[M])){I[M]-=i(R[G])}else{I[M]-=((i(R[M])+i(R[G]))/2)}}else{if(R[M]<R[G]){if(i(R[M])<=i(R[G])){I[M]+=i(R[M])}else{I[M]+=((i(R[M])+i(R[G]))/2)}}}R=j(P,L,I,E,Q,S,K);if(F[M]===N&&R[M]<0){I[M]+=i(R[M])}else{if(F[G]===N&&R[G]<0){I[M]-=i(R[G])}}}else{if((F[M]===N||F[M]===O)&&R[M]<0){I[M]+=i(R[M])}else{if((F[G]===N||F[G]===O)&&R[G]<0){I[M]-=i(R[G])}}}}}function C(G,N,S){var P=a(S),T=P.onCollision,M,R,K=d(N),L=s(N),H=g(t(N),true),W,E=P.base,V,I,U,F=P.container,O,Q,J;p.call(E)==="[object Array]"?(V=I=0,U=g(E[2]||o),U[w]+=E[0],U[A]+=E[1]):(V=d(E),I=s(E),U=g(E));M={left:e(P.position[0]+P.position[2],U[w]+P.offset.x-H[w],V,K),top:e(P.position[1]+P.position[3],U[A]+P.offset.y-H[A],I,L)};if(F){p.call(F)==="[object Array]"?(O=Q=0,J=g(F[2]||o),J[w]+=F[0],J[A]+=F[1]):(O=d(F),Q=s(F),J=g(F));R=j(K,L,M,H,O,Q,J);if(typeof T===r){W=g(N);T(M,R,{target:{element:N,width:K,height:L,offset:W,position:{left:W[w]>H[w]?i(W[w]-H[w]):-i(W[w]-H[w]),top:W[A]>H[A]?i(W[A]-H[A]):-i(W[A]-H[A])}},base:{element:E,width:V,height:I,offset:U},container:{element:F,width:O,height:Q,offset:J}})}else{T=x(T);if(T){m(K,L,M,H,O,Q,J,R,T)}}}if(G==="set"){N.style[w]=M[w]+"px";N.style[A]=M[A]+"px"}else{return M}}o[b]={set:function(E,F){C("set",E,F);return this},get:function(E,F){return C("get",E,F)},defaults:{base:o,position:"center center center center",offset:"0",container:null,onCollision:"push"}}})(window);