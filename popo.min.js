/*!
 * Popo JS - v0.7.8 - 14/2/2013
 *
 * Copyright (c) 2013 Niklas Rämö
 * Released under the MIT license
 */
(function(E,o){var H="popo",i=E.document,h=i.documentElement,v=i.body,y=E.Math,x=y.abs,m="left",l="right",g="top",t="bottom",u="center",G="function",s="number",F="getBoundingClientRect",n="clientWidth",L="clientHeight",e=Object.prototype.toString,w={nw:[l,t,m,g],n:[u,t,u,g],ne:[m,t,l,g],e:[m,u,l,u],se:[m,g,l,t],s:[u,g,u,t],sw:[l,g,m,t],w:[l,u,m,u],center:[u,u,u,u]};function b(M){return typeof String.prototype.trim===G?M.trim():M.replace(/^\s+|\s+$/g,"")}function D(M){var O={},N,P;for(N=0;N<M.length;N++){for(P in M[N]){O[P]=M[N][P]}}return O}function J(M){return M===E?(h[n]||v[n]):M===i?(y.max(h[n],h.offsetWidth,h.scrollWidth,v.scrollWidth,v.offsetWidth)):(M[F]().width||M.offsetWidth)}function z(M){return M===E?(h[L]||v[L]):M===i?(y.max(h[L],h.offsetHeight,h.scrollHeight,v.scrollHeight,v.offsetHeight)):(M[F]().height||M.offsetHeight)}function c(){return typeof E.pageXOffset===s?E.pageXOffset:h.scrollLeft||v.scrollLeft}function r(){return typeof E.pageYOffset===s?E.pageYOffset:h.scrollTop||v.scrollTop}function q(N,Q){var P=0,M=0,O;if(N===E){P=c();M=r()}else{if(N!==i){O=N[F]();if(typeof O!=="undefined"){P=O.left+c();M=O.top+r();if(Q===true){P+=N.clientLeft;M+=N.clientTop}}}}return{left:P,top:M}}function K(M){return M.style.position?(M.style.position):M.currentStyle?(M.currentStyle.position):i.defaultView&&i.defaultView.getComputedStyle?(i.defaultView.getComputedStyle(M,null).getPropertyValue("position")):("static")}function j(M){var N;if(M===h){N=i}else{if(M===v){N=h}else{N=M.offsetParent;while(N!==h&&K(N)==="static"){N=N===v?h:N.offsetParent}}}return N}function p(Q){var N=K(Q),T,P,S,O,R,M;N==="fixed"?(T={left:0,top:0}):N==="absolute"?(T=q(j(Q),true)):N!=="relative"?(T=q(Q)):(P=Q.style,S=P.left,O=P.right,R=P.top,M=P.bottom,P.left=P.right=P.top=P.bottom="auto",T=q(Q),P.left=S,P.right=O,P.top=R,P.bottom=M);return T}function f(M){var N=typeof M===G?b(M()).split(" "):M.split(" ");return N.length===1?w[N[0]].slice(0):N}function k(U){var P={x:0,y:0},R=1000000,S=typeof U===G?b(U()).split(","):U.split(","),N=S.length,M=E.parseFloat,W,V,O,T,Q;for(Q=0;Q<N;Q++){W=b(S[Q]).split(" ");V=W.length;if(V===2&&W[0].indexOf("deg")!==-1){O=M(W[0]);T=M(W[1]);if(typeof O===s&&typeof T===s&&T!==0){P.x+=y.round((y.cos(O*(y.PI/180))*T)*R)/R;P.y+=y.round((y.sin(O*(y.PI/180))*T)*R)/R}}else{if(V===1||V===2){P.x+=M(W[0]);P.y+=V===1?M(W[0]):M(W[1])}}}return P}function C(O){var N=typeof O==="string"&&O.length!==0?O.split(" "):"",M=N.length;if(M>0&&M<5){return{left:N[0],top:M>1?N[1]:N[0],right:M>2?N[2]:N[0],bottom:M===4?N[3]:M===1?N[0]:N[1]}}else{return null}}function I(N){var M=e.call(N)==="[object Object]"?D([E[H].defaults,N]):D([E[H].defaults]),O;for(O in M){if(typeof M[O]==="string"){M[O]=b(M[O])}}M.position=f(M.position);M.offset=k(M.offset);M.base=typeof M.base===G?M.base():M.base;M.container=typeof M.container===G?M.container():M.container;return M}function d(Q,P,O,N){var M={};M[m+m]=M[g+g]=P;M[m+u]=M[g+u]=P+(O/2);M[m+l]=M[g+t]=P+O;M[u+m]=M[u+g]=P-(N/2);M[u+u]=P+(O/2)-(N/2);M[u+l]=M[u+t]=P+O-(N/2);M[l+m]=M[t+g]=P-N;M[l+u]=M[t+u]=P-N+(O/2);M[l+l]=M[t+t]=P-N+O;return M[Q]}function A(N,M,P,S,R,Q,O){return{left:P.left+S.left-O.left,right:(O.left+R)-(P.left+S.left+N),top:P.top+S.top-O.top,bottom:(O.top+Q)-(P.top+S.top+M)}}function a(Y,U,Q,M,Z,aa,S,T,N){var X="push",W="push!",P=[[m,l],[g,t]],V,O,R;for(R=0;R<2;R++){V=P[R][0];O=P[R][1];if((N[V]===X||N[V]===W)&&(N[O]===X||N[O]===W)&&(T[V]<0||T[O]<0)){if(T[V]>T[O]){if(x(T[O])<=x(T[V])){Q[V]-=x(T[O])}else{Q[V]-=((x(T[V])+x(T[O]))/2)}}else{if(T[V]<T[O]){if(x(T[V])<=x(T[O])){Q[V]+=x(T[V])}else{Q[V]+=((x(T[V])+x(T[O]))/2)}}}T=A(Y,U,Q,M,Z,aa,S);if(N[V]===W&&T[V]<0){Q[V]+=x(T[V])}else{if(N[O]===W&&T[O]<0){Q[V]-=x(T[O])}}}else{if((N[V]===W||N[V]===X)&&T[V]<0){Q[V]+=x(T[V])}else{if((N[O]===W||N[O]===X)&&T[O]<0){Q[V]-=x(T[O])}}}}}function B(O,V,Z){var X=I(Z),aa=X.onCollision,S=J(V),T=z(V),P=p(V),U,M=X.base,ad,Q,ac,N,W,Y,R,ab;e.call(X.base)==="[object Array]"?(ad=Q=0,ac=q(M[2]||E),ac.left+=M[0],ac.top+=M[1]):(ad=J(M),Q=z(M),ac=q(M));U={left:d(X.position[0]+X.position[2],ac.left+X.offset.x-P.left,ad,S),top:d(X.position[1]+X.position[3],ac.top+X.offset.y-P.top,Q,T)};if(X.container!==null){N=X.container;W=J(N);Y=z(N);R=q(N);ab=A(S,T,U,P,W,Y,R);if(typeof aa===G){aa(U,{target:{element:V,width:S,height:T,offset:{x:P.x+U.x,y:P.y+U.y}},base:{element:M,width:ad,height:Q,offset:ac},container:{element:N,width:W,height:Y,offset:R,overflow:ab}})}else{aa=C(aa);if(aa!==null){a(S,T,U,P,W,Y,R,ab,aa)}}}if(O==="set"){V.style.left=U.left+"px";V.style.top=U.top+"px"}else{return U}}E[H]={set:function(M,N){B("set",M,N);return this},get:function(M,N){return B("get",M,N)},defaults:{position:u,offset:"0",base:E,container:null,onCollision:"push"}}})(window);