/*! Popo JS - v0.9.0 - 13/5/2013
 * https://github.com/niklasramo/popo
 * Copyright (c) 2012, 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license */
(function(n,l){var c="popo",C=n.document,g=n.Math,j=g.abs,w="left",y="right",z="top",t="bottom",d="center",q="function",p="documentElement",b="body",o="getBoundingClientRect",u=({}).toString;function v(D){return D.trim?D.trim():D.replace(/^\s+|\s+$/g,"")}function k(H){var F={},D=H.length,E,G;for(E=0;E<D;E++){for(G in H[E]){F[G]=H[E][G]}}return F}function i(D,E){return n.getComputedStyle?(n.getComputedStyle(D,null).getPropertyValue(E)):D.currentStyle?(D.currentStyle[E]):(null)}function s(E){var D=i(E,"position"),F=E.offsetParent;if(D=="fixed"){F=n}else{if(D=="absolute"){F=E===C[b]?C[p]:F||C;while(F!==C&&i(F,"position")=="static"){F=F===C[b]?C[p]:F.offsetParent||C}}}return F}function e(D){return D===n?(C[p].clientWidth):D===C||D===C[p]?(g.max(C[p].scrollWidth,C[b].scrollWidth)):(D[o]?D[o]().width:D.offsetWidth)}function r(D){return D===n?(C[p].clientHeight):D===C||D===C[p]?(g.max(C[p].scrollHeight,C[b].scrollHeight)):(D[o]?D[o]().height:D.offsetHeight)}function h(E,K){var H=0,D=0,I=n.pageXOffset||C[p].scrollLeft||C[b].scrollLeft||0,J=n.pageYOffset||C[p].scrollTop||C[b].scrollTop||0,G,F;if(E===n){H=I;D=J}else{if(E!==C&&E!==C[p]){G=E[o]&&E[o]();if(G){H+=G[w]+I-C[p].clientLeft;D+=G[z]+J-C[p].clientTop}else{H+=E.offsetLeft||0;D+=E.offsetTop||0;F=s(E);while(F){H+=F===n?I:F.offsetLeft||0;D+=F===n?J:F.offsetTop||0;F=s(F)}}if(K){H+=E.clientLeft||0;D+=E.clientTop||0}}}return{left:H,top:D}}function A(K){var E={x:0,y:0},D=n.parseFloat,G=1000000,J=typeof K===q?v(K()).split(","):K.split(","),M=J.length,L,I,H,F;for(F=M;F--;){L=v(J[F]).split(" ");I=D(L[0])||0;H=L.length>1?D(L[1])||0:I;if(L[0].indexOf("deg")>-1&&L.length>1&&H){E.x+=g.round((g.cos(I*(g.PI/180))*H)*G)/G;E.y+=g.round((g.sin(I*(g.PI/180))*H)*G)/G}else{E.x+=I;E.y+=H}}return E}function x(E){var G=typeof E==="string"&&E.length>0?E.split(" "):"",D=G.length,F=null;if(D>0&&D<5){F={left:G[0],top:D>1?G[1]:G[0],right:D>2?G[2]:G[0],bottom:D>3?G[3]:D<2?G[0]:G[1]}}return F}function a(D){D=u.call(D)==="[object Object]"?k([n[c].defaults,D]):k([n[c].defaults]);for(var E in D){if(typeof D[E]==="string"){D[E]=v(D[E])}}D.position=typeof D.position===q?D.position().split(" "):D.position.split(" ");D.base=typeof D.base===q?D.base():D.base;D.container=typeof D.container===q?D.container():D.container;D.offset=A(D.offset);return D}function f(H,G,F,E){var D={};D[w+w]=D[z+z]=G;D[w+d]=D[z+d]=G+(F/2);D[w+y]=D[z+t]=G+F;D[d+w]=D[d+z]=G-(E/2);D[d+d]=G+(F/2)-(E/2);D[d+y]=D[d+t]=G+F-(E/2);D[y+w]=D[t+z]=G-E;D[y+d]=D[t+d]=G-E+(F/2);D[y+y]=D[t+t]=G-E+F;return D[H]}function m(D,P,H){var L=0,M="push",E=M+"!",G=H?z:w,O=H?t:y,J=D[G],K=D[O],N=P[G],I=P[O],F=N+I;if((J==M||J==E)&&(K==M||K==E)&&(N<0||I<0)){if(N<I){L-=F<0?N+j(F/2):N}if(I<N){L+=F<0?I+j(F/2):I}N+=L;I-=L;if(J==E&&K!=E&&N<0){L-=N}if(K==E&&J!=E&&I<0){L+=I}}else{if((J==E||J==M)&&N<0){L-=N}else{if((K==E||K==M)&&I<0){L+=I}}}return L}function B(F,G,I){I=a(typeof G==="string"?I:G);var R=I.onCollision,L=e(F),M=r(F),H=h(s(F),1),U,N,O,D=I.base,T,J,S,E=I.container,P,Q,K;u.call(D)==="[object Array]"?(T=J=0,S=h(D[2]||n),S[w]+=D[0],S[z]+=D[1]):(T=e(D),J=r(D),S=h(D));O={left:f(I.position[0]+I.position[2],S[w]+I.offset.x-H[w],T,L),top:f(I.position[1]+I.position[3],S[z]+I.offset.y-H[z],J,M)};if(E){u.call(E)==="[object Array]"?(P=Q=0,K=h(E[2]||n),K[w]+=E[0],K[z]+=E[1]):(P=e(E),Q=r(E),K=h(E));N={left:O[w]+H[w]-K[w],right:(K[w]+P)-(O[w]+H[w]+L),top:O[z]+H[z]-K[z],bottom:(K[z]+Q)-(O[z]+H[z]+M)};if(typeof R===q){U=h(F);R(O,N,{target:{element:F,width:L,height:M,offset:U,position:{left:U[w]>H[w]?j(U[w]-H[w]):-j(U[w]-H[w]),top:U[z]>H[z]?j(U[z]-H[z]):-j(U[z]-H[z])}},base:{element:D,width:T,height:J,offset:S},container:{element:E,width:P,height:Q,offset:K}})}else{R=x(R);if(R){O[w]+=m(R,N);O[z]+=m(R,N,1)}}}if(G==="get"){return O}else{F.style[w]=O[w]+"px";F.style[z]=O[z]+"px";return F}}n[c]=B;n[c].defaults={base:n,position:"center center center center",offset:"0",container:null,onCollision:"none"}})(window);