/*! Popo JS - v0.9.0dev - 14/5/2013
 * https://github.com/niklasramo/popo
 * Copyright (c) 2012, 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license */
(function(o,m){var c="popo",E=o.document,g=o.Math,k=g.abs,y="left",A="right",B="top",u="bottom",d="center",v="width",i="height",r="function",q="documentElement",b="body",p="getBoundingClientRect",w=({}).toString;function x(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function l(J){var H={},F=J.length,G,I;for(G=0;G<F;G++){for(I in J[G]){H[I]=J[G][I]}}return H}function j(F,G){return o.getComputedStyle?(o.getComputedStyle(F,null).getPropertyValue(G)):F.currentStyle?(F.currentStyle[G]):(null)}function t(F){var G=F.offsetParent,H=G&&j(F,"position");if(H=="fixed"){G=o}else{if(H=="absolute"){G=F===E[b]?E[q]:G||E;while(G!==E&&j(G,"position")=="static"){G=G===E[b]?E[q]:G.offsetParent||E}}}return G}function e(F){return F===o?(E[q].clientWidth):F===E||F===E[q]?(g.max(E[q].scrollWidth,E[b].scrollWidth)):(F[p]&&v in F[p]()?F[p]()[v]:F.offsetWidth)}function s(F){return F===o?(E[q].clientHeight):F===E||F===E[q]?(g.max(E[q].scrollHeight,E[b].scrollHeight)):(F[p]&&i in F[p]()?F[p]()[i]:F.offsetHeight)}function h(G,M){var J=0,F=0,K=o.pageXOffset||E[q].scrollLeft||E[b].scrollLeft||0,L=o.pageYOffset||E[q].scrollTop||E[b].scrollTop||0,I=G,H;if(G===o){J=K;F=L}else{if(G!==E&&G!==E[q]){H=G[p]&&G[p]();if(H&&y in H&&B in H){J+=H[y]+K-E[q].clientLeft;F+=H[B]+L-E[q].clientTop}else{while(I){J+=I===o?K:I.offsetLeft||0;F+=I===o?L:I.offsetTop||0;I=t(I)}}if(M){J+=G.clientLeft||0;F+=G.clientTop||0}}}return{left:J,top:F}}function C(M){var G={x:0,y:0},F=o.parseFloat,I=1000000,L=typeof M===r?x(M()).split(","):M.split(","),O=L.length,N,K,J,H;for(H=O;H--;){N=x(L[H]).split(" ");K=F(N[0])||0;J=N.length>1?F(N[1])||0:K;if(N[0].indexOf("deg")>-1&&N.length>1&&J){G.x+=g.round((g.cos(K*(g.PI/180))*J)*I)/I;G.y+=g.round((g.sin(K*(g.PI/180))*J)*I)/I}else{G.x+=K;G.y+=J}}return G}function z(G){var I=typeof G==="string"&&G.length>0?G.split(" "):"",F=I.length,H=null;if(F>0&&F<5){H={left:I[0],top:F>1?I[1]:I[0],right:F>2?I[2]:I[0],bottom:F>3?I[3]:F<2?I[0]:I[1]}}return H}function a(F){F=w.call(F)==="[object Object]"?l([o[c].defaults,F]):l([o[c].defaults]);for(var G in F){if(typeof F[G]==="string"){F[G]=x(F[G])}}F.position=typeof F.position===r?F.position().split(" "):F.position.split(" ");F.base=typeof F.base===r?F.base():F.base;F.container=typeof F.container===r?F.container():F.container;F.offset=C(F.offset);return F}function f(J,I,H,G){var F={};F[y+y]=F[B+B]=I;F[y+d]=F[B+d]=I+(H/2);F[y+A]=F[B+u]=I+H;F[d+y]=F[d+B]=I-(G/2);F[d+d]=I+(H/2)-(G/2);F[d+A]=F[d+u]=I+H-(G/2);F[A+y]=F[u+B]=I-G;F[A+d]=F[u+d]=I-G+(H/2);F[A+A]=F[u+u]=I-G+H;return F[J]}function n(F,R,J){var N=0,O="push",G=O+"!",I=J?B:y,Q=J?u:A,L=F[I],M=F[Q],P=R[I],K=R[Q],H=P+K;if((L==O||L==G)&&(M==O||M==G)&&(P<0||K<0)){if(P<K){N-=H<0?P+k(H/2):P}if(K<P){N+=H<0?K+k(H/2):K}P+=N;K-=N;if(L==G&&M!=G&&P<0){N-=P}if(M==G&&L!=G&&K<0){N+=K}}else{if((L==G||L==O)&&P<0){N-=P}else{if((M==G||M==O)&&K<0){N+=K}}}return N}function D(H,I,K){K=a(typeof I==="string"?K:I);var T=K.onCollision,N=e(H),O=s(H),J=h(t(H),1),W,P,Q,F=K.base,V,L,U,G=K.container,R,S,M;w.call(F)==="[object Array]"?(V=L=0,U=h(F[2]||o),U[y]+=F[0],U[B]+=F[1]):(V=e(F),L=s(F),U=h(F));Q={left:f(K.position[0]+K.position[2],U[y]+K.offset.x-J[y],V,N),top:f(K.position[1]+K.position[3],U[B]+K.offset.y-J[B],L,O)};if(G){w.call(G)==="[object Array]"?(R=S=0,M=h(G[2]||o),M[y]+=G[0],M[B]+=G[1]):(R=e(G),S=s(G),M=h(G));P={left:Q[y]+J[y]-M[y],right:(M[y]+R)-(Q[y]+J[y]+N),top:Q[B]+J[B]-M[B],bottom:(M[B]+S)-(Q[B]+J[B]+O)};if(typeof T===r){W=h(H);T(Q,P,{target:{element:H,width:N,height:O,offset:W,position:{left:W[y]>J[y]?k(W[y]-J[y]):-k(W[y]-J[y]),top:W[B]>J[B]?k(W[B]-J[B]):-k(W[B]-J[B])}},base:{element:F,width:V,height:L,offset:U},container:{element:G,width:R,height:S,offset:M}})}else{T=z(T);if(T){Q[y]+=n(T,P);Q[B]+=n(T,P,1)}}}if(I==="get"){return Q}else{H.style[y]=Q[y]+"px";H.style[B]=Q[B]+"px";return H}}o[c]=D;o[c].defaults={base:o,position:"center center center center",offset:"0",container:null,onCollision:"none"}})(window);