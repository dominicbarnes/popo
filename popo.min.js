/*! Popo - v0.9.0dev - 17/5/2013
 * https://github.com/niklasramo/popo
 * Copyright (c) 2012, 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license */
(function(o,m){var c="popo",D=o.document,g=o.Math,k=g.abs,z="left",A="right",B="top",u="bottom",d="center",v="width",i="height",r="function",w="string",q="documentElement",b="body",p="getBoundingClientRect",x=({}).toString;function y(E){return typeof E===w?(E.trim?E.trim():E.replace(/^\s+|\s+$/g,"")):E}function l(I){var G={},E=I.length,F,H;for(F=0;F<E;F++){for(H in I[F]){G[H]=I[F][H]}}return G}function j(E,F){return o.getComputedStyle?(o.getComputedStyle(E,null).getPropertyValue(F)):E.currentStyle?(E.currentStyle[F]):(null)}function t(E){var F=E.offsetParent,G="style" in E&&j(E,"position");if(G=="fixed"){F=o}else{if(G=="absolute"){F=E===D[b]?D[q]:F||D;while("style" in F&&j(F,"position")=="static"){F=F===D[b]?D[q]:F.offsetParent||D}}}return F}function e(E){return E===o?(D[q].clientWidth):E===D||E===D[q]?(g.max(D[q].scrollWidth,D[b].scrollWidth)):(E[p]&&v in E[p]()?E[p]()[v]:E.offsetWidth)}function s(E){return E===o?(D[q].clientHeight):E===D||E===D[q]?(g.max(D[q].scrollHeight,D[b].scrollHeight)):(E[p]&&i in E[p]()?E[p]()[i]:E.offsetHeight)}function h(F,L){var I=0,E=0,J=o.pageXOffset||D[q].scrollLeft||D[b].scrollLeft||0,K=o.pageYOffset||D[q].scrollTop||D[b].scrollTop||0,H=F,G;if(F===o){I=J;E=K}else{if(F!==D&&F!==D[q]){G=F[p]&&F[p]();if(G&&z in G&&B in G){I+=G[z]+J-(D[q].clientLeft||0);E+=G[B]+K-(D[q].clientTop||0)}else{while(H){I+=H===o?J:H.offsetLeft||0;E+=H===o?K:H.offsetTop||0;H=t(H)}}if(L){I+=F.clientLeft||0;E+=F.clientTop||0}}}return{left:I,top:E}}function a(O){O=x.call(O)==="[object Object]"?l([o[c].defaults,O]):l([o[c].defaults]);for(var E in O){O[E]=y(typeof O[E]!==r?O[E]:E=="onCollision"?O[E]:O[E]());if(E=="position"){O[E]=O[E].split(" ")}if(E=="offset"){var F=typeof O[E]===w?O[E].split(","):[],M={x:0,y:0},H=1000000,N,J,I,G;for(G=F.length;G--;){N=y(F[G]).split(" ");J=parseFloat(N[0])||0;I=N.length>1?parseFloat(N[1])||0:J;if(N[0].indexOf("deg")>-1&&N.length>1&&I){M.x+=g.round((g.cos(J*(g.PI/180))*I)*H)/H;M.y+=g.round((g.sin(J*(g.PI/180))*I)*H)/H}else{M.x+=J;M.y+=I}}O[E]=M}if(E=="onCollision"){var M=typeof O[E]===r?O[E]:null,L,K;if(typeof O[E]===w&&O[E].length>0){L=O[E].split(" ");K=L.length;if(K>0&&K<5){M={left:L[0],top:K>1?L[1]:L[0],right:K>2?L[2]:L[0],bottom:K>3?L[3]:K<2?L[0]:L[1]}}}O[E]=M}}return O}function f(I,H,G,F){var E={};E[z+z]=E[B+B]=H;E[z+d]=E[B+d]=H+(G/2);E[z+A]=E[B+u]=H+G;E[d+z]=E[d+B]=H-(F/2);E[d+d]=H+(G/2)-(F/2);E[d+A]=E[d+u]=H+G-(F/2);E[A+z]=E[u+B]=H-F;E[A+d]=E[u+d]=H-F+(G/2);E[A+A]=E[u+u]=H-F+G;return E[I]}function n(E,Q,I){var M=0,N="push",F=N+"!",H=I?B:z,P=I?u:A,K=E[H],L=E[P],O=Q[H],J=Q[P],G=O+J;if((K==N||K==F)&&(L==N||L==F)&&(O<0||J<0)){if(O<J){M-=G<0?O+k(G/2):O}if(J<O){M+=G<0?J+k(G/2):J}O+=M;J-=M;if(K==F&&L!=F&&O<0){M-=O}if(L==F&&K!=F&&J<0){M+=J}}else{if((K==F||K==N)&&O<0){M-=O}else{if((L==F||L==N)&&J<0){M+=J}}}return M}function C(G,H,J){J=a(typeof H===w?J:H);var S=J.onCollision,M=e(G),N=s(G),I=h(t(G),1),V,O,P,E=J.base,U,K,T,F=J.container,Q,R,L;x.call(E)==="[object Array]"?(U=K=0,T=h(E[2]||o),T[z]+=E[0],T[B]+=E[1]):(U=e(E),K=s(E),T=h(E));P={left:f(J.position[0]+J.position[2],T[z]+J.offset.x-I[z],U,M),top:f(J.position[1]+J.position[3],T[B]+J.offset.y-I[B],K,N)};if(F){x.call(F)==="[object Array]"?(Q=R=0,L=h(F[2]||o),L[z]+=F[0],L[B]+=F[1]):(Q=e(F),R=s(F),L=h(F));O={left:P[z]+I[z]-L[z],right:(L[z]+Q)-(P[z]+I[z]+M),top:P[B]+I[B]-L[B],bottom:(L[B]+R)-(P[B]+I[B]+N)};if(typeof S===r){V=h(G);S(P,O,{target:{element:G,width:M,height:N,offset:V,position:{left:V[z]>I[z]?k(V[z]-I[z]):-k(V[z]-I[z]),top:V[B]>I[B]?k(V[B]-I[B]):-k(V[B]-I[B])}},base:{element:E,width:U,height:K,offset:T},container:{element:F,width:Q,height:R,offset:L}})}else{if(S){P[z]+=n(S,O);P[B]+=n(S,O,1)}}}if(H==="get"){return P}else{G.style[z]=P[z]+"px";G.style[B]=P[B]+"px";return G}}o[c]=C;o[c].defaults={base:o,position:"center center center center",offset:"0",container:null,onCollision:"none"}})(window);