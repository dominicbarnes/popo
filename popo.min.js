/*!
 * Popo JS - v0.7.6 - 8/2/2013
 *
 * Copyright (c) 2013 Niklas Rämö
 * Released under the MIT license
 */
(function(C,k){var E="popo",g=C.document,f=g.documentElement,B=g.body,u=C.Math,t=u.abs,c={},e=Object.prototype.toString,K="left",x="right",j="top",G="bottom",H="center",n="function",F="number",s={nw:[x,G,K,j],n:[H,G,H,j],ne:[K,G,x,j],e:[K,H,x,H],se:[K,j,x,G],s:[H,j,H,G],sw:[x,j,K,G],w:[x,H,K,H],center:[H,H,H,H]};c[K+K]=c[j+j]=function(P,O,N){return P};c[K+H]=c[j+H]=function(P,O,N){return P+(O/2)};c[K+x]=c[j+G]=function(P,O,N){return P+O};c[H+K]=c[H+j]=function(P,O,N){return P-(N/2)};c[H+H]=function(P,O,N){return P+(O/2)-(N/2)};c[H+x]=c[H+G]=function(P,O,N){return P+O-(N/2)};c[x+K]=c[G+j]=function(P,O,N){return P-N};c[x+H]=c[G+H]=function(P,O,N){return P-N+(O/2)};c[x+x]=c[G+G]=function(P,O,N){return P-N+O};function L(N){return e.call(N)==="[object global]"}function m(N){return e.call(N)==="[object HTMLDocument]"}function D(N){return e.call(N)==="[object HTMLHtmlElement]"}function p(N){return e.call(N)==="[object HTMLBodyElement]"}function b(N){return typeof String.prototype.trim===n?N.trim():N.replace(/^\s+|\s+$/g,"")}function A(N){var P={},O,Q;for(O=0;O<N.length;O++){for(Q in N[O]){P[Q]=N[O][Q]}}return P}function I(N){if(L(N)){return f.clientWidth||B.clientWidth}else{if(m(N)){return u.max(f.clientWidth,f.offsetWidth,f.scrollWidth,B.scrollWidth,B.offsetWidth)}else{return N.getBoundingClientRect().width||N.offsetWidth}}}function v(N){if(L(N)){return f.clientHeight||B.clientHeight}else{if(m(N)){return u.max(f.clientHeight,f.offsetHeight,f.scrollHeight,B.scrollHeight,B.offsetHeight)}else{return N.getBoundingClientRect().height||N.offsetHeight}}}function d(){return typeof C.pageXOffset===F?C.pageXOffset:f.scrollLeft||B.scrollLeft}function o(){return typeof C.pageYOffset===F?C.pageYOffset:f.scrollTop||B.scrollTop}function l(O,R){var Q=0,N=0,P;if(L(O)){Q=d();N=o()}else{if(!m(O)){P=O.getBoundingClientRect();if(typeof P!=="undefined"){Q=P.left+d();N=P.top+o();if(R===true){Q+=O.clientLeft;N+=O.clientTop}}}}return{left:Q,top:N}}function J(N){if(N.style.position){return N.style.position}else{if(N.currentStyle){return N.currentStyle.position}else{if(g.defaultView&&g.defaultView.getComputedStyle){return g.defaultView.getComputedStyle(N,null).getPropertyValue("position")}else{return"static"}}}}function h(N){var O;if(D(N)){O=g}else{if(p(N)){O=f}else{O=N.offsetParent;while(!D(O)&&J(O)==="static"){O=p(O)?f:O.offsetParent}}}return O}function r(R){var O=J(R),U,Q,T,P,S,N;if(O==="fixed"){U={left:0,top:0}}else{if(O==="absolute"){U=l(h(R),true)}else{if(O!=="relative"){U=l(R)}else{Q=R.style;T=Q.left;P=Q.right;S=Q.top;N=Q.bottom;Q.left=Q.right=Q.top=Q.bottom="auto";U=l(R);Q.left=T;Q.right=P;Q.top=S;Q.bottom=N}}}return U}function q(Q,S,O){var R=Q.className.split(" "),N=R.length,P;for(P=0;P<N;P++){if(R[P].substring(0,S.length)===S){R.splice(P,1)}}if(O!==""){R.push(O)}Q.className=R.join(" ")}function z(P){var O=typeof P==="string"&&P.length!==0?P.split(" "):"",N=O.length;if(N>0&&N<5){return{left:O[0],top:N>1?O[1]:O[0],right:N>2?O[2]:O[0],bottom:N===4?O[3]:(N===1?O[0]:O[1])}}else{return null}}function i(S){var P={x:0,y:0},R=1000000,T=S.split(","),N=T.length,W,V,O,U,Q;for(Q=0;Q<N;Q++){W=b(T[Q]).split(" ");V=W.length;if(V===2&&W[0].indexOf("deg")!==-1){O=parseFloat(W[0]);U=parseFloat(W[1]);if(typeof O===F&&typeof U===F&&U!==0){P.x+=u.round((u.cos(O*(u.PI/180))*U)*R)/R;P.y+=u.round((u.sin(O*(u.PI/180))*U)*R)/R}}else{if(V===1||V===2){P.x+=parseFloat(W[0]);P.y+=V===1?parseFloat(W[0]):parseFloat(W[1])}}}return P}function M(O){var N=e.call(O)==="[object Object]"?A([C[E].defaults,O]):A([C[E].defaults]),P;for(P in N){if(typeof N[P]==="string"){N[P]=b(N[P])}}if(N.setClass){N.cls=E+"-"+N.position.replace(/\s+/g,"-")}N.position=N.position.split(" ");N.position=N.position.length===1?s[N.position[0]].slice(0):N.position;N.offset=i(N.offset);if(N.container!==null&&typeof N.onCollision!==n){N.onCollision=z(N.onCollision)}return N}function w(P,N,R,O,T,S,Q){return{left:R.left+O.left-Q.left,right:(Q.left+T)-(R.left+O.left+P),top:R.top+O.top-Q.top,bottom:(Q.top+S)-(R.top+O.top+N)}}function a(Z,V,R,Q,aa,ab,T,U,N){var Y="push",X="push!",P=[[K,x],[j,G]],W,O,S;for(S=0;S<2;S++){W=P[S][0];O=P[S][1];if((N[W]===Y||N[W]===X)&&(N[O]===Y||N[O]===X)&&(U[W]<0||U[O]<0)){if(U[W]>U[O]){if(t(U[O])<=t(U[W])){R[W]-=t(U[O])}else{R[W]-=((t(U[W])+t(U[O]))/2)}}else{if(U[W]<U[O]){if(t(U[W])<=t(U[O])){target.position[W]+=t(U[W])}else{R[W]+=((t(U[W])+t(U[O]))/2)}}}U=w(Z,V,R,Q,aa,ab,T);if(N[W]===X&&U[W]<0){R[W]+=t(U[W])}else{if(N[O]===X&&U[O]<0){R[W]-=t(U[O])}}}else{if((N[W]===X||N[W]===Y)&&U[W]<0){R[W]+=t(U[W])}else{if((N[O]===X||N[O]===Y)&&U[O]<0){R[W]-=t(U[O])}}}}}function y(P,V,aa){var Y=M(aa),ae=e.call(Y.base)==="[object Array]",S=I(V),T=v(V),X=r(V),U,N=Y.base,ad,Q,ac,O,W,Z,R,ab;if(ae){ad=Q=0;ac=l(N[2]||C);ac.left+=N[0];ac.top+=N[1]}else{ad=I(N);Q=v(N);ac=l(N)}if(Y.setClass&&(" "+V.className+" ").indexOf(" "+Y.cls+" ")===-1){q(V,E,Y.cls)}U={left:c[Y.position[0]+Y.position[2]](ac.left+Y.offset.x-X.left,ad,S),top:c[Y.position[1]+Y.position[3]](ac.top+Y.offset.y-X.top,Q,T)};if(Y.container!==null){O=Y.container;W=I(O);Z=v(O);R=l(O);ab=w(S,T,U,X,W,Z,R);if(typeof Y.onCollision===n){Y.onCollision(U,V,N,O)}else{if(Y.onCollision!==null){a(S,T,U,X,W,Z,R,ab,Y.onCollision)}}}if(P==="set"){V.style.left=U.left+"px";V.style.top=U.top+"px"}else{return U}}C[E]={set:function(N,O){y("set",N,O);return this},get:function(N,O){return y("get",N,O)},defaults:{position:H,offset:"0",base:C,setClass:false,container:null,onCollision:"push"}}})(window);