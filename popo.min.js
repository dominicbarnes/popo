/*! Popo JS - v0.9dev - 19/5/2013
 * https://github.com/niklasramo/popo
 * Copyright (c) 2012, 2013 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license */
(function(k,h){var b="popo",j=k.parseFloat,d=k.Math,g=d.abs,y=({}).toString,z="left",E="right",F="top",r="bottom",c="center",u="width",e="height",q="function",v="string",l="getBoundingClientRect",f,G,C,p;function D(H){return H.self===f.self}function i(H){return typeof H===v?(H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")):H}function w(L){var J={},H=L.length,I,K;for(I=0;I<H;I++){for(K in L[I]){J[K]=L[I][K]}}return J}function s(H,I){return f.getComputedStyle?(f.getComputedStyle(H,null).getPropertyValue(I)):H.currentStyle?(H.currentStyle[I]):(null)}function n(H){var I=H.offsetParent,J="style" in H&&s(H,"position");if(J==="fixed"){I=f}else{if(J==="absolute"){I=H===p?C:I||G;while("style" in I&&s(I,"position")==="static"){I=I===p?C:I.offsetParent||G}}}return I}function m(H){return D(H)?(C.clientWidth):H===G||H===C?(d.max(C.scrollWidth,p.scrollWidth)):(H[l]&&u in H[l]()?H[l]()[u]:H.offsetWidth)}function a(H){return D(H)?(C.clientHeight):H===G||H===C?(d.max(C.scrollHeight,p.scrollHeight)):(H[l]&&e in H[l]()?H[l]()[e]:H.offsetHeight)}function x(I,O){var K=0,H=0,L=f.pageXOffset||C.scrollLeft||p.scrollLeft||0,N=f.pageYOffset||C.scrollTop||p.scrollTop||0,J=I,M;if(D(I)){K=L;H=N}else{if(I!==G&&I!==C){M=I[l]&&I[l]();if(M&&z in M&&F in M){K+=M[z]+L-(C.clientLeft||0);H+=M[F]+N-(C.clientTop||0)}else{while(J){K+=D(J)?L:J.offsetLeft||0;H+=D(J)?N:J.offsetTop||0;J=n(J)}}if(O){K+=I.clientLeft||0;H+=I.clientTop||0}}}return{left:K,top:H}}function o(I,T){var J=k[b].defaults,H,L,R,K,M,S,O,N,Q,P;T=y.call(T)==="[object Object]"?w([J,T]):w([J]);for(H in T){T[H]=i(typeof T[H]!==q?T[H]:H==="onCollision"?T[H]:T[H](I));if(H==="position"){T[H]=T[H].split(" ")}if(H==="offset"){R={x:0,y:0};K=typeof T[H]===v?T[H].split(","):[];M=1000000;for(L=K.length;L--;){S=i(K[L]).split(" ");O=j(S[0])||0;N=S.length>1?j(S[1])||0:O;if(S[0].indexOf("deg")>-1&&S.length>1&&N){R.x+=d.round((d.cos(O*(d.PI/180))*N)*M)/M;R.y+=d.round((d.sin(O*(d.PI/180))*N)*M)/M}else{R.x+=O;R.y+=N}}T[H]=R}if(H==="onCollision"){R=typeof T[H]===q?T[H]:null;if(typeof T[H]===v&&T[H].length>0){Q=T[H].split(" ");P=Q.length;if(P>0&&P<5){R={left:Q[0],top:P>1?Q[1]:Q[0],right:P>2?Q[2]:Q[0],bottom:P>3?Q[3]:P<2?Q[0]:Q[1]}}}T[H]=R}}return T}function t(L,K,J,I){var H={};H[z+z]=H[F+F]=K;H[z+c]=H[F+c]=K+(J/2);H[z+E]=H[F+r]=K+J;H[c+z]=H[c+F]=K-(I/2);H[c+c]=K+(J/2)-(I/2);H[c+E]=H[c+r]=K+J-(I/2);H[E+z]=H[r+F]=K-I;H[E+c]=H[r+c]=K-I+(J/2);H[E+E]=H[r+r]=K-I+J;return H[L]}function A(J,T,N){var R=0,S="push",Q=S+"!",I=N?F:z,H=N?r:E,O=J[I],M=J[H],K=T[I],P=T[H],L=K+P;if((O===S||O===Q)&&(M===S||M===Q)&&(K<0||P<0)){if(K<P){R-=L<0?K+g(L/2):K}if(P<K){R+=L<0?P+g(L/2):P}K+=R;P-=R;if(O===Q&&M!=Q&&K<0){R-=K}if(M===Q&&O!=Q&&P<0){R+=P}}else{if((O===Q||O===S)&&K<0){R-=K}else{if((M===Q||M===S)&&P<0){R+=P}}}return R}function B(J,K,M){G=J.ownerDocument;f=G.defaultView||G.parentWindow;C=G.documentElement;p=G.body;M=o(J,typeof K===v?M:K);var V=M.onCollision,S,R,Y,P=m(J),Q=a(J),L=x(n(J),1),H=M.base,X,N,W,I=M.container,T,U,O;y.call(H)==="[object Array]"?(X=N=0,W=x(H[2]||f),W[z]+=H[0],W[F]+=H[1]):(X=m(H),N=a(H),W=x(H));S={left:t(M.position[0]+M.position[2],W[z]+M.offset.x-L[z],X,P),top:t(M.position[1]+M.position[3],W[F]+M.offset.y-L[F],N,Q)};if(I){y.call(I)==="[object Array]"?(T=U=0,O=x(I[2]||f),O[z]+=I[0],O[F]+=I[1]):(T=m(I),U=a(I),O=x(I));R={left:S[z]+L[z]-O[z],right:(O[z]+T)-(S[z]+L[z]+P),top:S[F]+L[F]-O[F],bottom:(O[F]+U)-(S[F]+L[F]+Q)};if(typeof V===q){Y=x(J);V(S,R,{target:{element:J,width:P,height:Q,offset:Y,position:{left:Y[z]>L[z]?g(Y[z]-L[z]):-g(Y[z]-L[z]),top:Y[F]>L[F]?g(Y[F]-L[F]):-g(Y[F]-L[F])}},base:{element:H,width:X,height:N,offset:W},container:{element:I,width:T,height:U,offset:O}})}else{if(V){S[z]+=A(V,R);S[F]+=A(V,R,1)}}}if(K==="get"){return S}else{J.style[z]=S[z]+"px";J.style[F]=S[F]+"px";return J}}k[b]=B;k[b].defaults={base:function(I,H){H=I.ownerDocument;return H.defaultView||H.parentWindow},position:"center center center center",offset:"0",container:null,onCollision:"none"}})(window);