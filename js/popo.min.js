/*! popo.js v1.0 | 2013-08-15 | Copyright (c) 2012, 2013 Niklas Rämö | Released under the MIT license | http://github.com/niklasramo/popo */
(function(h,e){var i="popo",g=h.parseFloat,b=h.Math,p=b.abs,c,w,u,n;function k(y,x){y=({}).toString.call(y).split(" ")[1].replace("]","").toLowerCase();return x?y===x:y}function f(x){return k(x,"string")?(x.trim?x.trim():x.replace(/^\s+|\s+$/g,"")):x}function r(B){var z={},x=B.length,y,A;for(y=0;y<x;y++){for(A in B[y]){if(B[y].hasOwnProperty(A)){z[A]=B[y][A]}}}return z}function v(x){return x.self===c.self}function o(x,y){return c.getComputedStyle?(c.getComputedStyle(x,null).getPropertyValue(y)):x.currentStyle?(x.currentStyle[y]):(null)}function j(x){var y=x.offsetParent,z="style" in x&&o(x,"position");if(z==="fixed"){y=c}else{if(z==="absolute"){y=x===n?u:y||w;while("style" in y&&o(y,"position")==="static"){y=y===n?u:y.offsetParent||w}}}return y}function l(x,y){return v(x)?(u.clientWidth):x===w||x===u?(b.max(u.scrollWidth,n.scrollWidth)):(y=x.getBoundingClientRect&&x.getBoundingClientRect(),y&&"width" in y?y.width:x.offsetWidth)}function a(x,y){return v(x)?(u.clientHeight):x===w||x===u?(b.max(u.scrollHeight,n.scrollHeight)):(y=x.getBoundingClientRect&&x.getBoundingClientRect(),y&&"height" in y?y.height:x.offsetHeight)}function s(y,E){var A=0,x=0,B=c.pageXOffset||u.scrollLeft||n.scrollLeft||0,D=c.pageYOffset||u.scrollTop||n.scrollTop||0,z=y,C;if(v(y)){A=B;x=D}else{if(y!==w&&y!==u){C=y.getBoundingClientRect&&y.getBoundingClientRect();if(C&&"left" in C&&"top" in C){A+=C.left+B-(u.clientLeft||0);x+=C.top+D-(u.clientTop||0)}else{while(z){A+=v(z)?B:z.offsetLeft||0;x+=v(z)?D:z.offsetTop||0;z=j(z)}}if(E){A+=y.clientLeft||0;x+=y.clientTop||0}}}return{left:A,top:x}}function m(B,A){var y=h[i].defaults,D,z,C,x;A=r(k(A,"object")?[y,A]:[y]);for(D in A){A[D]=f(k(A[D],"function")&&D!=="collision"?A[D](B):A[D]);if(D==="position"){A[D]=A[D].split(" ")}if(D==="offset"){z=k(A[D],"string")?A[D].split(" "):[];A.offsetX=g(z[0])||0;A.offsetY=z.length>1?g(z[1])||0:A.offsetX}if(D==="collision"){z=k(A[D],"function")?A[D]:null;if(k(A[D],"string")&&A[D].length>0){C=A[D].split(" ");x=C.length;if(x>0&&x<5){z={left:C[0],top:x>1?C[1]:C[0],right:x>2?C[2]:C[0],bottom:x>3?C[3]:x<2?C[0]:C[1]}}}A[D]=z}}return A}function q(E,D,B,C,A,z){var x={},y=D+C-B;x.leftleft=x.toptop=y;x.leftcenter=x.topcenter=y+(A/2);x.leftright=x.topbottom=y+A;x.centerleft=x.centertop=y-(z/2);x.centercenter=y+(A/2)-(z/2);x.centerright=x.centerbottom=y+A-(z/2);x.rightleft=x.bottomtop=y-z;x.rightcenter=x.bottomcenter=y-z+(A/2);x.rightright=x.bottombottom=y-z+A;return x[E]}function d(I,J,B){var F=0,G="push",E="push+",y=B?"top":"left",x=B?"bottom":"right",H=I[y],z=I[x],D=J[y],C=J[x],A=D+C;if((H===G||H===E)&&(z===G||z===E)&&(D<0||C<0)){if(D<C){F-=A<0?D+p(A/2):D}if(C<D){F+=A<0?C+p(A/2):C}D+=F;C-=F;if(H===E&&z!=E&&D<0){F-=D}if(z===E&&H!=E&&C<0){F+=C}}else{if((H===E||H===G)&&D<0){F-=D}else{if((z===E||z===G)&&C<0){F+=C}}}return F}function t(z,A,C){w=z.ownerDocument;c=w.defaultView||w.parentWindow;u=w.documentElement;n=w.body;C=m(z,k(A,"string")?C:A);var F=C.collision,G=l(z),H=a(z),B=s(j(z),1),x=C.base,O,D,N,y=C.container,L,M,E,P,K,I,J;k(x,"array")?(O=D=0,N=s(x[2]||c),N.left+=x[0],N.top+=x[1]):(O=l(x),D=a(x),N=s(x));J={left:q(C.position[0]+C.position[2],N.left,B.left,C.offsetX,O,G),top:q(C.position[1]+C.position[3],N.top,B.top,C.offsetY,D,H)};if(y){k(y,"array")?(L=M=0,E=s(y[2]||c),E.left+=y[0],E.top+=y[1]):(L=l(y),M=a(y),E=s(y));I={left:J.left+B.left-E.left,right:(E.left+L)-(J.left+B.left+G),top:J.top+B.top-E.top,bottom:(E.top+M)-(J.top+B.top+H)};if(k(F,"function")){P=s(z);K={left:P.left>B.left?p(P.left-B.left):-p(P.left-B.left),top:P.top>B.top?p(P.top-B.top):-p(P.top-B.top)};F(J,I,{target:{element:z,width:G,height:H,offset:P,position:K},base:{element:x,width:O,height:D,offset:N},container:{element:y,width:L,height:M,offset:E}})}else{if(F){J.left+=d(F,I);J.top+=d(F,I,1)}}}if(A==="get"){return J}else{z.style.left=J.left+"px";z.style.top=J.top+"px";return z}}h[i]=t;h[i].defaults={base:function(y,x){x=y.ownerDocument;return x.defaultView||x.parentWindow},container:null,position:"center center center center",offset:"0",collision:"none"}})(self);